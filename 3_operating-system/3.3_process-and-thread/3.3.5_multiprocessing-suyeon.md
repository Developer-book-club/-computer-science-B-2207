## 멀티프로세싱

: 두개 이상의 CPU(코어와 프로세스)를 활용하는 시스템

- 멀티 스레딩 : 하나의 프로세스 안에 두개 이상의 스레드가 있을 때 컨텍스트 스위칭을 통한 병렬처리.

- 멀티 태스킹 : 여러 프로세스 간, 혹은 여러 스레드 간의 컨텍스트 스위칭을 통한 병렬처리

* 듀얼 코어와 싱글 코어 멀티 태스킹의 차이 :
  스레드가 두개라면, 싱글 코어에서는 하나의 프로세서가 두 스레드를 처리해야 해서 빠른 컨텍스트 스위칭을 통한 병렬처리를 수행하지만 듀얼 코어에서는 각각의 프로세서가 스레드 하나씩을 맡아서 처리하므로 진정한 의미의 병렬처리가 수행됨

### 웹 브라우저가 사용하는 프로세스 (아키텍처)

- 브라우저 프로세스 : 주소 표시줄, 북마크 막대, 뒤로 가기 버튼, 앞으로 가기 버튼 등을 담당하고, 네트워크 요청이나 파일 접근 같은 권한도 담당한다.

- 렌더러 프로세스 : 탭 안에서 웹사이트가 표시되는 부분의 모든 것을 제어한다.

- 플러그인 프로세스 : 웹사이트에서 사용하는 플러그인을 제어한다.

- GPU 프로세스 : 화면을 그리는 작업을 제어한다. GPU는 여러 애플리케이션의 요청을 받아서 화면에 그리는 작업만을 처리하기 때문에, 다른 프로세스와 격리해서 처리된다.

\*GPU는 그래픽 카드의 부품 중 하나인데 그래픽카드와 동일시되기도 한다. 그래픽카드는 CPU에 내장된 내장 그래픽카드와 외장 그래픽카드로 나누어진다.

### 프로세스간 협력이 필요한 이유

정보 공유 (Information sharing) : 여러 사용자가(혹은 프로세스 간에) 동일한 정보를 필요로 할 수 있다.

계산 가속화 (Computation speedup) : 특정 작업(task)를 빠르게 실행하기 위해, 해당 작업을 부분 작업(서브 태스크)으로 나눠서 병렬로 실행하게 할 수 있다.

모듈성 (Modularity) : 특정한 시스템 기능을 별도의 프로세스(스레드)로 구분하여 모듈식 형태로 시스템을 구성할 수 있다.

편의성 (Convenience) : 여러 사용자들이 동시에 많은 작업을 수행할 수 있다.

[출처](https://junghyungil.tistory.com/146)

### IPC (Inter Process Communication)

프로세스 간의 데이터 통신, 공유.
한 프로세스 내부의 스레드들은 서로 heap영역의 데이터를 공유하지만 프로세스들은 서로 공유하는 메모리영역이 없으므로 IPC를 통해 통신한다. 따라서 스레드와 다르게 데이터를 전달하는 데 시간이 소모된다.

- 공유 메모리 : 여러 프로세스에 동일한 메모리 블록에 대한 접근 권한이 부여되고, 프로세스가 서로 통신할 수 있도록 만들어놓은 공유 버퍼 영역. IPC중 가장 빠르다. 공유 메모리는 RAM에서 공유할 영역을 직접 지정해야 사용할 수 있다. 동기화가 필요하다.

[예시](https://jjakang2.tistory.com/53)

```bash
echo 8589934592 > /proc/sys/kernel/shmmax
echo 4194304 > /proc/sys/kernel/shmall
ipcs -l

#  ------ Shared Memory Limits --------
# max number of segments = 4096
# max seg size (kbytes) = 8388608  (8GB)
# max total shared memory (kbytes) = 16777216 (16GB)
# min seg size (bytes) = 1
```

- 파일 : 디스크(비휘발성 메모리)에 저장된 데이터 또는 파일 서버에서 제공한 데이터

- 소켓 : 컴퓨터 네트워크를 경유하는 프로세스 간 통신을 위한 엔드포인트. 동일한 컴퓨터의 프로세스 간, 혹은 네트워크 통신을 하는 다른 컴퓨터에 데이터를 전송할 때 이 소켓을 통해 전송한다. 이 소켓을 통해 전송되는 데이터는 TCP, UDP가 있다.

- 익명 파이프 : 단방향 프로세스 간 통신에 사용될 수있는 단순한 FIFO 통신 채널. 부모, 자식 프로세스 간에만 사용할 수 있으며 다른 네트워크 상에는 사용이 불가능하다.

- 명명 파이프 : 파이프 서버와 하나 이상의 파이프 클라이언트 간의 통신을 위해 명명된 단방향 또는 이중 파이프이다.

익명파이프가 프로세스 진행 동안에만 지속되는 것과 달리 명명 파이프는 OS가 동작하고 있다면 프로세스의 수명을 넘어서 지속될 수 있다.

다른 네트워크의 컴퓨터와도 통신할 수 있다.

- 메시지 큐(분산 메시징 시스템) : 프로세스가 사용하는 메시지를 큐 데이터 구조로 관리하는 것. 메시지 큐는 커널에서 전역적으로 관리된다. 커널에서 보관하고 있으니 프로세스가 종료되어도 사라지지 않는다. IPC를 통한 데이터의 읽기, 쓰기 빈도가 높다면 공유 메모리 대신 메시지 큐를 이용하기도 한다.

대용량 데이터를 처리하기 위한 작업이나 채팅 서비스, 나중에 처리할 수 있는 비동기 데이터에 주로 사용된다. 클라이언트의 요청이 많아져서 응답해야 할 게 많다면, 다소 지연시간(오버헤드)을 희생하더라도 중간버퍼 역할로 메시지 큐를 두고 이곳에서 모든 데이터를 처리하게 하여 \*데이터 유실을 방지하고, 필요한 프로그램에 작업을 분산시키도록 하는 것이다.

\*데이터 유실 방지 : 메시지 큐는 어떤 특정 메시지가 최소한 한번은 전달될 수 있도록 보장하기 때문에 데이터 유실을 방지할 수 있다.

---

#### 참고링크

[\[NaverD2\]최신 브라우저의 내부 살펴보기 1 - CPU, GPU, 메모리 그리고 다중 프로세스 아키텍처](https://d2.naver.com/helloworld/2922312)
