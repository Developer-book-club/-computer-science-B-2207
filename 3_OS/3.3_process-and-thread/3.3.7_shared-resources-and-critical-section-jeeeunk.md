## 3.3.7 공유 자원과 임계 영역

### 공유 자원 Shared Resource

- 시스템 안에서 각각 프로세스, 스레드가 함께 접근할 수 있는 자원이나 변수
- 모니터, 프린터, 메모리, 파일 등

### 임계 영역 Critical Section

- 여러 프로세스가 데이터를 공유하면서 수행될 때, 각 프로세스에서 공유 자원에 접근하는 프로그램 코드 부분
- 경쟁 상태가 발생하지 않도록 공유 자원의 독점을 보장해야 함

### 경쟁 상태 Race Condition

- 공유 자원에 여러 프로세스/스레드가 접근할 때 타이밍, 순서 등이 결과 값에 영향을 줄 수 있는 상태
- 자료의 일관성을 해칠 수 있음
- 해결하기 위한 방법: 크게 `잠금 lock` 이라는 매커니즘을을 토대로 한 뮤텍스, 세마포어, 모니터 세 개가 있으며  상호 배제, 한정 대기, 융통성이라는 조건 만족
    
    <aside>
    💡 상호 배제 Mutual Exclusion : 한 프로세스가 임계 영역에 들어갔을 때 다른 프로세스는 자신의 임계 영역에 들어갈 수 없다.
    
    </aside>
    
    <aside>
    💡 한정 대기 Bounded Waiting: 특정 프로세스가 영원이 임계 영역에 들어가기 위해 대기해서는 (starvation) 안 된다.
    
    </aside>
    
    <aside>
    💡 융통성: 한 프로세스가 다른 프로세스의 일을 방해해서는 안 된다.
    
    </aside>
    

### 뮤텍스 Mutex

- 멀티 프로그래밍 환경에서 자원 접근을 강제로 제한하기 위한 동기화 기법
- 공유 자원을 사용하기 전에 설정하고 사용 후에 해제
- 잠금이 설정되면 다른 스레드는 잠긴 코드 영역에 접근 할 수 없음
- Boolean 타입의 Lock 변수를 사용
- 뮤텍스는 하나의 상태 (잠금 또는 잠금 해제)만 가짐, 따라서 공유 자원 한개에 대한 접근을 제어

### 세마포어 Semaphore

- 멀티 프로그래밍 환경에서 다수의 프로세스나 스레드가 공유 자원 한 개 / 복수 개에 대한 접근을 제한하는 방법으로 사용하는 동기화 방법
- 일반화된 뮤텍스
- 정수값을 갖는 변수로, 자원의 개수를 의미
- 간단한 정수 값과 두 가지 함수 wait(), signal()로 공유 자원에 대한 접근을 처리
- 프로세스가 공유 자원에 접근하면 세마포어에서 wait() 작업을 수행, 프로세스가 공유 자원을 해제하면 세마포어에서 signal() 함수 작업을 수해
    - wait(): 자신의 차례가 올 때까지 기다리는 함수로 P 함수라고도 함
    - signal(): 다음 프로세스로 순서를 넘겨주는 함수로 V 함수라고도 함
- 바이너리 세마포어 Binary Semaphore
    - 0, 1만 값으로 가질 수 있는 세마포어 (하나의 스레드만 관리)
    - 뮤텍스와 유사하지만, 뮤텍스는 리소스에 대한 접근을 동기화하는 데 사용하는 잠금 매커니즘이고 세마포어는 신호를 기반으로 상호 배제가 일어나는 신호 매커니즘
- 카운팅 세마포어 Counting Semaphore
    - 여러 개의 값 (시스템 내 가용한 자원의 수) 을 가질 수 있는 세마포어
    - 여러 지원에 대한 접근을 제어하는데 사용

### 모니터 Monitor

- 둘 이상의 스레드나 프로세스가 공유 자원에 안전하게 접근할 수 있도록 공유 자원을 숨기고 해당 접근에 대해 인터페이스만 제공
- 프레임워크나 라이브러리에서 제공되어 세마포어보다 구현하기 쉬우며, 상호 배제는 자동으로 구현